<topology>
	<gateway>
		<provider>
			<role>webappsec</role>
			<name>WebAppSec</name>
			<enabled>true</enabled>
			<param>
				<name>xframe.options.enabled</name>
				<value>true</value>
			</param>
		</provider>
		<provider>
			<role>authentication</role>
			<name>ShiroProvider</name>
			<enabled>true</enabled>
			<param>
				<name>sessionTimeout</name>
				<value>30</value>
			</param>
			<param>
				<name>redirectToUrl</name>
				<value>/gateway/knoxsso/knoxauth/login.html</value>
			</param>
			<param>
				<name>restrictedCookies</name>
				<value>rememberme,WWW-Authenticate</value>
			</param>
			<param>
				<name>main.ldapRealm</name>
				<value>org.apache.hadoop.gateway.shirorealm.KnoxLdapRealm</value>
			</param>
			<!-- changes for AD/user sync -->
			<param>
				<name>main.ldapContextFactory</name>
				<value>org.apache.hadoop.gateway.shirorealm.KnoxLdapContextFactory</value>
			</param>
			<!-- main.ldapRealm.contextFactory needs to be placed before other main.ldapRealm.contextFactory* entries  -->
			<param>
				<name>main.ldapRealm.contextFactory</name>
				<value>$ldapContextFactory</value>
			</param>
			<!-- AD url -->
			<param>
				<name>main.ldapRealm.contextFactory.url</name>
				<value>ldap://$ACTIVE_DIRECTORY_HOSTNAME:389</value>
			</param>
			<!-- system user -->
			<param>
				<name>main.ldapRealm.contextFactory.systemUsername</name>
				<value>$AD_USERNAME</value>
			</param>
			<!-- pass in the password using the alias created earlier -->
			<param>
				<name>main.ldapRealm.contextFactory.systemPassword</name>
				<value>$AD_PASSWORD</value>
			</param>
			<param>
				<name>main.ldapRealm.contextFactory.authenticationMechanism</name>
				<value>simple</value>
			</param>
			<param>
				<name>urls./**</name>
				<value>authcBasic</value>
			</param>
			<param>
				<name>main.ldapRealm.searchBase</name>
				<value>$AD_BASE</value>
			</param>
			<param>
				<name>main.ldapRealm.userObjectClass</name>
				<value>person</value>
			</param>
			<param>
				<name>main.ldapRealm.userSearchAttributeName</name>
				<value>sAMAccountName</value>
			</param>
			<provider>
				<role>identity-assertion</role>
				<name>Default</name>
				<enabled>true</enabled>
			</provider>
			<application>
				<name>knoxauth</name>
			</application>
			<service>
				<role>KNOXSSO</role>
				<param>
					<name>knoxsso.cookie.secure.only</name>
					<value>false</value>
				</param>
				<param>
					<name>knoxsso.cookie.domain.suffix</name>
					<value>*</value>
				</param>
				<param>
					<name>knoxsso.token.ttl</name>
					<value>86400000</value>
				</param>
				<param>
					<name>knoxsso.cookie.samesite</name>
					<value>Lax</value>
				</param>
			</service>
		</topology>
